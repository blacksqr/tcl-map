%  $Id: stat.tex,v 1.2 2006/03/01 23:34:21 dav480 Exp $ 
    % NAP Library: stat.tcl
    \section{Statistical Functions}

  \subsection{
    \label{Introduction}Introduction
  }
These are defined in 
  \texttt{stat.tcl}. Note that there are also built-in statistical
  functions called 
  \href{function.html\#Correlation}{ \texttt{correlation} } and 
  \href{function.html\#Correlation}{ \texttt{moving-correlation} }. The 
  \href{op.html\#Tally}{Tally Unary Operator `\texttt{\#}"} also has statistical applications.
  \subsection{
    \label{Simple-Statistics}Simple Statistics
  }

  

Three examples are provided for each function. The first uses the
  vector 
  \texttt{v} which is defined as follows (note the missing
  values):
  \begin{verbatim}
% nap "v = {12 6 _ 7 3 15 _ 10 18 6}"
\end{verbatim}

  

The second example produces statistics of each column of a matrix.
  The third example produces statistics of each row of the same matrix.
  This matrix is called 
  \texttt{m} and is defined as follows:
  \begin{verbatim}
% nap "m = {
    {1.5 2.1 1.5 0.2}
    {6.2 4.9   _ 0.2}
}"
\end{verbatim}

  \subsubsection{
    \label{am}Arithmetic mean: \texttt{am(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "am(v)"]
9.625
% [nap "am(m)"]
3.85 3.5 1.5 0.2
% [nap "am(m,1)"]
1.325 3.76667
\end{verbatim}

  \subsubsection{
    \label{gm}Geometric mean: \texttt{gm(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "gm(v)"]
8.38752
% [nap "gm(m)"]
3.04959 3.2078 1.5 0.2
% [nap "gm(m,1)"]
0.985957 1.82476
\end{verbatim}

  \subsubsection{
    \label{median}Median: \texttt{median(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "median(v)"]
8.5
% [nap "median(m)"]
3.85 3.5 1.5 0.2
% [nap "median(m,1)"]
1.5 4.9
\end{verbatim}

  \subsubsection{
    \label{mode}Mode: \texttt{mode(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "mode(v)"]
6
% [nap "mode(m)"]
3.85 3.5 1.5 0.2
% [nap "mode(m,1)"]
1.50625 3.7625
\end{verbatim}

  \subsubsection{
    \label{percentile}Percentiles: \texttt{percentile(}$x$\texttt{,} $pc$[\texttt{,} $verb\_rank$[\texttt{,} $nc$]]\texttt{)}
  }

  


  $pc$ = vector of required percentiles
  \\
  $nc$ = number of class intervals (default: 256)
  

The following examples calculate the following percentiles:
  \begin{itemize}
    \item 0 (minimum)
    \item 50 (median)
    \item 100 (maximum)
  \end{itemize}
  \begin{verbatim}
% [nap "percentile(v, {0 50 100})"]
3 8.50781 18
% [nap "percentile(m, {0 50 100})"]
1.50000 2.10000 1.50000 0.20000
3.85918 3.50547 1.50000 0.20000
6.20000 4.90000 1.50000 0.20000
% [nap "percentile(m, {0 50 100}, 1)"]
0.20000 0.20000
1.50254 4.92266
2.10000 6.20000
\end{verbatim}

  \subsubsection{
    \label{rms}Root mean square: \texttt{rms(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "rms(v)"]
10.7413
% [nap "rms(m)"]
4.51054 3.76962 1.5 0.2
% [nap "rms(m,1)"]
1.49583 4.56399
\end{verbatim}

  \subsubsection{
    \label{sd}Standard-deviation (with division by n): \texttt{sd(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "sd(v)"]
4.76806
% [nap "sd(m)"]
2.35 1.4 0 0
% [nap "sd(m,1)"]
0.694172 2.57725
\end{verbatim}

  \subsubsection{
    \label{sd1}Standard-deviation (with division by n-1): \texttt{sd1(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "sd1(v)"]
5.09727
% [nap "sd1(m)"]
3.3234 1.9799 _ 0
% [nap "sd1(m,1)"]
0.801561 3.15647
\end{verbatim}

  \subsubsection{
    \label{var}Variance (with division by n): \texttt{var(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "var(v)"]
22.7344
% [nap "var(m)"]
5.5225 1.96 0 0
% [nap "var(m,1)"]
0.481875 6.64222
\end{verbatim}

  \subsubsection{
    \label{var1}Variance (with division by n-1): \texttt{var1(}$x$[\texttt{,} $verb\_rank$]\texttt{)}
  }

  \begin{verbatim}
% [nap "var1(v)"]
25.9821
% [nap "var1(m)"]
11.045 3.92 _ 0
% [nap "var1(m,1)"]
0.6425 9.96333
\end{verbatim}

  \subsection{
    \label{moving-average}Moving Average: \texttt{moving\_average(}$x$\texttt{,} $shape\_window$[, $step$]\texttt{)}
  }
Move window of specified shape by specified step (can vary for
  each dimension). Result is arithmetic mean of 
  $x$ values in each window. 
  $x$ can have any rank $>$ 0.
  


  $shape\_window$ is either a scalar or a vector with an
  element for each dimension. If it is a scalar then it is treated as a
  vector with 
  \texttt{rank(}
  $x$
  \texttt{)} identical elements.
  

Similarly, 
  $step$ is either a scalar or a vector with an element for
  each dimension. If it is a scalar then it is treated as a vector with
  \texttt{rank(}
  $x$
  \texttt{)} identical elements. The default value for 
  $step$ is 1. If 
  $step$ has the same value as 
  $shape\_window$ then the windows do not overlap. The value -1
  is treated like 1, except that missing values are prepended $\backslash$\&amp;
  appended (along this dimension of 
  $x$) to produce a result with the same dimension size as 
  $x$.
  

The following examples illustrate the application of 
  \texttt{moving\_average} to a vector.
  \begin{verbatim}
% nap "v = {12 6 _ 7 3 15 _ 10 18 5}"
% [nap "moving_average(v, 3)"] value
9 6.5 5 8.33333 9 12.5 14 11
% [nap "moving_average(v, 3, 3)"] value
9 8.33333 14
% [nap "moving_average(v, 3, -1)"] value
9 9 6.5 5 8.33333 9 12.5 14 11 11.5
\end{verbatim}

  

The following examples illustrate the application of 
  \texttt{moving\_average} to a matrix.
  \begin{verbatim}
% nap "m = {
    {1 2 1 4 0 0}
    {5 4 2 9 2 7}
    {0 1 1 3 1 4}
}"
% [nap "moving_average(m, {3 3})"] value
1.88889 3.00000 2.55556 3.33333
% [nap "moving_average(m, {3 3}, {3 3})"] value
1.88889 3.33333
% [nap "moving_average(m, 3, 3)"] value
1.88889 3.33333
% [nap "moving_average(m, 3, -1)"] value
3.00000 2.50000 3.66667 3.00000 3.66667 2.25000
2.16667 1.88889 3.00000 2.55556 3.33333 2.33333
2.50000 2.16667 3.33333 3.00000 4.33333 3.50000
% [nap "moving_average(m, {1 3})"] value
1.333333 2.333333 1.666667 1.333333
3.666667 5.000000 4.333333 6.000000
0.666667 1.666667 1.666667 2.666667
\end{verbatim}

